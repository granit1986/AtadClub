function __processArg(e,t){var l=null;return e&&(l=e[t]||null,delete e[t]),l}function Controller(){function e(){g.openIndicator();try{p=Alloy.Collections.publicAdverts.where({id:h})[0].toJSON()}catch(e){p=Alloy.Collections.adverts.where({id:h})[0].toJSON()}if(d.window.title=p.name,d.nameVal.text=p.name,b){var l=Ti.UI.createButton({title:L("edit")});d.window.setRightNavButton(l),l.addEventListener("click",function(){var e=Alloy.createController("add/advert",{advertId:p.id,callback:function(){d.window.close()}}).getView();Alloy.CFG.tabAccount.open(e)})}if(p.images){p.images=JSON.parse(p.images);for(var o=0;o<p.images.length;o++){var i="";i=Ti.UI.createImageView(-1!=p.images[o]?{image:"http://"+Ti.App.serverDomain+"/api/"+Titanium.App.ApiVersion+"/image/"+p.images[o]+Alloy.Globals.imageSizes.advert.view(),imageOriginal:"http://"+Ti.App.serverDomain+"/api/"+Titanium.App.ApiVersion+"/image/"+p.images[o]+Alloy.Globals.imageSizes.advert.original(),wihth:"180dp",height:"180dp"}:{image:"appicon-72.png",wihth:"180dp",height:"180dp"}),i.addEventListener("click",t),d.images.addView(i)}p.images.length>0&&w.createWindow(d.images.views)}d.priceVal.text=p.price,d.descriptionVal.text=p.description,d.user.text=p.user,d.email.text=p.email,d.phone.text=p.phone,d.address.text=p.address,d.mapImage.image="http://maps.googleapis.com/maps/api/staticmap?center="+p.lat.replace(",",".")+","+p.lng.replace(",",".")+"8&zoom=16&size=280x180&sensor=false&markers=color:red%7Clabel:D%7C"+p.lat.replace(",",".")+","+p.lng.replace(",",".")+"%7Csize:tiny",b&&(d.scroll.remove(d.contactLbl),d.scroll.remove(d.user),d.scroll.remove(d.email),d.scroll.remove(d.phone),d.scroll.remove(d.priceOffer),d.scroll.remove(d.barterOffer),d.scroll.remove(d.emailLbl),d.scroll.remove(d.phoneLbl),d.scroll.remove(d.address),d.scroll.remove(d.addressLbl),d.scroll.remove(d.mapImage)),g.closeIndicator()}function t(){var e=d.images.getCurrentPage();w.openWindow(e)}function l(){var e=Ti.UI.createEmailDialog();e.subject=L("about_you_advert_subject"),e.toRecipients=[p.email],e.messageBody=String.format(L("about_you_advert_message"),p.user),e.open()}function o(){var e=Alloy.createController("home/adverts/advertMap",{advert:p}).getView();Alloy.CFG.tabHome.open(e)}function i(){Titanium.Platform.openURL("tel:"+p.phone)}function s(){Alloy.CFG.tabHome.open(Alloy.createController("home/adverts/priceOffer",{advertId:p.id}).getView())}function a(){Alloy.CFG.tabHome.open(Alloy.createController("home/adverts/barterOffer",{advertId:p.id}).getView())}function r(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBgOnTap}function n(e){if(e.source.backgroundColor=Alloy.Globals.Styles.buttonBg,!Alloy.Globals.core.apiToken()){var t=Titanium.UI.createAlertDialog({title:L("signup_or_signin_title"),message:L("signup_or_signin_message"),buttonNames:[L("no"),L("yes")],cancel:0});return t.addEventListener("click",function(e){e.cancel!==e.index&&!0!==e.cancel&&Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabAccount)}),t.show(),void g.closeIndicator()}"priceOffer"==e.source.id?s():"barterOffer"==e.source.id&&a()}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="home/adverts/advert",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var d=this,c={},u={};d.__views.window=Ti.UI.createWindow({backgroundImage:Alloy.Globals.Styles.backgroundImage,layout:"vertical",id:"window",fullscreen:"true"}),d.__views.window&&d.addTopLevelView(d.__views.window),e?d.__views.window.addEventListener("open",e):u["$.__views.window!open!open"]=!0,d.__views.scroll=Ti.UI.createScrollView({layout:"vertical",left:"20dp",right:"20dp",id:"scroll"}),d.__views.window.add(d.__views.scroll),d.__views.nameVal=Ti.UI.createLabel({height:"80dp",width:Ti.UI.FILL,textAlign:"center",color:Alloy.Globals.Styles.titleColor,font:{fontSize:"25dp",fontFamily:"OleoScriptSwashCaps-Regular"},id:"nameVal",textid:"name"}),d.__views.scroll.add(d.__views.nameVal);var y=[];d.__views.images=Ti.UI.createScrollableView({width:"280dp",height:"180dp",left:"0dp",bottom:"10dp",contenWidth:"180dp",borderColor:"#ccc",borderWidth:"1dp",backgroundColor:"#fff",views:y,id:"images",showPagingControl:"true"}),d.__views.scroll.add(d.__views.images),d.__views.priceLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"priceLbl",textid:"price"}),d.__views.scroll.add(d.__views.priceLbl),d.__views.priceVal=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.inputLeft,right:Alloy.Globals.Styles.inputRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#555",id:"priceVal"}),d.__views.scroll.add(d.__views.priceVal),d.__views.__alloyId200=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId200"}),d.__views.scroll.add(d.__views.__alloyId200),d.__views.descriptionLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"descriptionLbl",textid:"description"}),d.__views.scroll.add(d.__views.descriptionLbl),d.__views.descriptionVal=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.inputLeft,right:Alloy.Globals.Styles.inputRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#555",id:"descriptionVal"}),d.__views.scroll.add(d.__views.descriptionVal),d.__views.__alloyId201=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId201"}),d.__views.scroll.add(d.__views.__alloyId201),d.__views.contactLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"contactLbl",textid:"seller"}),d.__views.scroll.add(d.__views.contactLbl),d.__views.user=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.inputLeft,right:Alloy.Globals.Styles.inputRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#555",id:"user"}),d.__views.scroll.add(d.__views.user),d.__views.__alloyId202=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId202"}),d.__views.scroll.add(d.__views.__alloyId202),d.__views.emailLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"emailLbl",textid:"email"}),d.__views.scroll.add(d.__views.emailLbl),d.__views.email=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.inputLeft,right:Alloy.Globals.Styles.inputRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#00accb",id:"email"}),d.__views.scroll.add(d.__views.email),l?d.__views.email.addEventListener("click",l):u["$.__views.email!click!onClickEmail"]=!0,d.__views.__alloyId203=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId203"}),d.__views.scroll.add(d.__views.__alloyId203),d.__views.phoneLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"phoneLbl",textid:"advert_phone"}),d.__views.scroll.add(d.__views.phoneLbl),d.__views.phone=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.inputLeft,right:Alloy.Globals.Styles.inputRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#00accb",id:"phone"}),d.__views.scroll.add(d.__views.phone),i?d.__views.phone.addEventListener("click",i):u["$.__views.phone!click!phoneCall"]=!0,d.__views.__alloyId204=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId204"}),d.__views.scroll.add(d.__views.__alloyId204),d.__views.addressLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"addressLbl",textid:"address"}),d.__views.scroll.add(d.__views.addressLbl),d.__views.address=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.inputLeft,right:Alloy.Globals.Styles.inputRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#00accb",id:"address"}),d.__views.scroll.add(d.__views.address),o?d.__views.address.addEventListener("click",o):u["$.__views.address!click!onClickAddress"]=!0,d.__views.mapImage=Ti.UI.createImageView({id:"mapImage",image:""}),d.__views.scroll.add(d.__views.mapImage),o?d.__views.mapImage.addEventListener("click",o):u["$.__views.mapImage!click!onClickAddress"]=!0,d.__views.__alloyId205=Ti.UI.createView({height:"20dp",width:Ti.UI.FILL,id:"__alloyId205"}),d.__views.scroll.add(d.__views.__alloyId205),d.__views.priceOffer=Ti.UI.createButton({width:"180dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"priceOffer",titleid:"send_my_price_offer"}),d.__views.scroll.add(d.__views.priceOffer),r?d.__views.priceOffer.addEventListener("touchstart",r):u["$.__views.priceOffer!touchstart!buttonTouchStart"]=!0,n?d.__views.priceOffer.addEventListener("touchend",n):u["$.__views.priceOffer!touchend!buttonTouchEnd"]=!0,d.__views.barterOffer=Ti.UI.createButton({width:"180dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"barterOffer",titleid:"send_my_barter_offer"}),d.__views.scroll.add(d.__views.barterOffer),r?d.__views.barterOffer.addEventListener("touchstart",r):u["$.__views.barterOffer!touchstart!buttonTouchStart"]=!0,n?d.__views.barterOffer.addEventListener("touchend",n):u["$.__views.barterOffer!touchend!buttonTouchEnd"]=!0,c.destroy=function(){},_.extend(d,d.__views);var p,b=arguments[0].forEdit||null,h=arguments[0].id||null,g=Alloy.Globals.indicator,w={window:!1,view:!1,openWindow:function(e){var t=this;t.window.open(),t.view.setCurrentPage(e)},createWindow:function(e){var t=this;t.window=Ti.UI.createWindow({width:"100%",height:"100%",backgroundColor:"#f0f0f0",orientationModes:[Ti.UI.PORTRAIT,Ti.UI.LANDSCAPE_LEFT,Ti.UI.LANDSCAPE_RIGHT]});var l=Ti.UI.createButton({title:"X",width:"30dp",height:"30dp",right:"5dp",top:"5dp",zIndex:10,backgroundColor:Alloy.Globals.Styles.buttonBg,color:"#fff"});l.addEventListener("click",function(){t.window.close()});for(var o=[],i=0;i<e.length;i++){var s=e[i],a=Ti.UI.createImageView({image:s.imageOriginal});o.push(a)}t.view=Ti.UI.createScrollableView({showPagingControl:!0,views:o}),t.window.add(t.view),t.window.add(l)}};u["$.__views.window!open!open"]&&d.__views.window.addEventListener("open",e),u["$.__views.email!click!onClickEmail"]&&d.__views.email.addEventListener("click",l),u["$.__views.phone!click!phoneCall"]&&d.__views.phone.addEventListener("click",i),u["$.__views.address!click!onClickAddress"]&&d.__views.address.addEventListener("click",o),u["$.__views.mapImage!click!onClickAddress"]&&d.__views.mapImage.addEventListener("click",o),u["$.__views.priceOffer!touchstart!buttonTouchStart"]&&d.__views.priceOffer.addEventListener("touchstart",r),u["$.__views.priceOffer!touchend!buttonTouchEnd"]&&d.__views.priceOffer.addEventListener("touchend",n),u["$.__views.barterOffer!touchstart!buttonTouchStart"]&&d.__views.barterOffer.addEventListener("touchstart",r),u["$.__views.barterOffer!touchend!buttonTouchEnd"]&&d.__views.barterOffer.addEventListener("touchend",n),_.extend(d,c)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;