function __processArg(e,t){var l=null;return e&&(l=e[t]||null,delete e[t]),l}function Controller(){function e(e){t(e)}function t(e){e.source.id!==r.price.id&&r.price.blur(),e.source.id!==r.description.id&&r.description.blur(),r.scrollView.setContentOffset({x:0,y:0})}function l(e){t(e)}function o(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBgOnTap}function i(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBg,"sendPriceOffer"==e.source.id&&s()}function s(){var e=Alloy.createModel("priceOffer",{advertId:c.id,price:r.price.value,description:r.description.value});e.localValidate(a)&&e.save({},{success:function(){r.window.close(),Alloy.Globals.core.showErrorDialog(L("offer_sent"))},error:function(e,t){if(t&&t.Message){var l=Titanium.UI.createAlertDialog({title:L("upgrade_membership"),message:L(t.Message),buttonNames:[L("upgrade"),L("OK")]});l.addEventListener("click",function(e){if(!e.index){var t=Alloy.createController("account/upgradeSelect").getView();Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabAccount),Alloy.Globals.tabGroup.activeTab.open(t)}}),l.show()}}})}function a(e){switch(e){case errors.NO_DESCRIPTION:r.description.focus();break;case errors.NO_PRICE:r.price.focus();break;case errors.INVALID_PRICE:r.price.focus()}Alloy.Globals.core.showError(e)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="home/adverts/priceOffer",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var r=this,n={},d={};r.__views.window=Ti.UI.createWindow({backgroundImage:Alloy.Globals.Styles.backgroundImage,layout:"vertical",id:"window",fullscreen:"true",titleid:"my_price_offer"}),r.__views.window&&r.addTopLevelView(r.__views.window),e?r.__views.window.addEventListener("click",e):d["$.__views.window!click!blur"]=!0,l?r.__views.window.addEventListener("focus",l):d["$.__views.window!focus!focus"]=!0,r.__views.scrollView=Ti.UI.createScrollView({layout:"vertical",left:"20dp",right:"20dp",id:"scrollView",scrollingEnabled:"false"}),r.__views.window.add(r.__views.scrollView),r.__views.__alloyId211=Ti.UI.createView({height:"20dp",width:Ti.UI.FILL,id:"__alloyId211"}),r.__views.scrollView.add(r.__views.__alloyId211),r.__views.priceLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"priceLbl",textid:"price"}),r.__views.scrollView.add(r.__views.priceLbl),r.__views.price=Ti.UI.createTextField({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"price",keyboardType:Ti.UI.KEYBOARD_DECIMAL_PAD}),r.__views.scrollView.add(r.__views.price),l?r.__views.price.addEventListener("focus",l):d["$.__views.price!focus!focus"]=!0,r.__views.descriptionLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"descriptionLbl",textid:"description"}),r.__views.scrollView.add(r.__views.descriptionLbl),r.__views.description=Ti.UI.createTextArea(function(){var e={};return Alloy.Globals.isHe&&_.extend(e,{textAlign:"right"}),_.extend(e,{width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputAreaHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"description"}),e}()),r.__views.scrollView.add(r.__views.description),l?r.__views.description.addEventListener("focus",l):d["$.__views.description!focus!focus"]=!0,r.__views.sendPriceOffer=Ti.UI.createButton({width:"120dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"sendPriceOffer",titleid:"send"}),r.__views.scrollView.add(r.__views.sendPriceOffer),o?r.__views.sendPriceOffer.addEventListener("touchstart",o):d["$.__views.sendPriceOffer!touchstart!buttonTouchStart"]=!0,i?r.__views.sendPriceOffer.addEventListener("touchend",i):d["$.__views.sendPriceOffer!touchend!buttonTouchEnd"]=!0,n.destroy=function(){},_.extend(r,r.__views);var c=Alloy.Collections.publicAdverts.where({id:arguments[0].advertId})[0].toJSON();d["$.__views.window!click!blur"]&&r.__views.window.addEventListener("click",e),d["$.__views.window!focus!focus"]&&r.__views.window.addEventListener("focus",l),d["$.__views.price!focus!focus"]&&r.__views.price.addEventListener("focus",l),d["$.__views.description!focus!focus"]&&r.__views.description.addEventListener("focus",l),d["$.__views.sendPriceOffer!touchstart!buttonTouchStart"]&&r.__views.sendPriceOffer.addEventListener("touchstart",o),d["$.__views.sendPriceOffer!touchend!buttonTouchEnd"]&&r.__views.sendPriceOffer.addEventListener("touchend",i),_.extend(r,n)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;