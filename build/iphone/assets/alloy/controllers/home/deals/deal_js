function __processArg(e,t){var l=null;return e&&(l=e[t]||null,delete e[t]),l}function Controller(){function e(){k.openIndicator();try{C=Alloy.Collections.publicDeals.where({id:A})[0].toJSON()}catch(e){try{C=Alloy.Collections.homeDeals.where({id:A})[0].toJSON()}catch(e){try{C=Alloy.Collections.companyDeals.where({id:A})[0].toJSON()}catch(e){try{C=Alloy.Collections.deals.where({id:A})[0].toJSON(),E=!0}catch(e){C=Alloy.Collections.similarDeals.where({id:A})[0].toJSON()}}}}E?a():t()}function t(){var e=Alloy.createModel("publicDeal"),t=0;Alloy.Globals.profile?t=Alloy.Globals.profile.id:l(),e.fetch({data:{dealId:A,installId:Alloy.Globals.core.installId,lat:S,lng:I,userId:t,lang:Ti.Platform.locale},success:function(){C=e.toJSON(),C.needDeleteComplaint&&i(),C.needDeleteRate&&o(),a()},error:function(){k.closeIndicator(),Alloy.Globals.core.showErrorDialog(L("xhr_error"))}})}function l(){G=!1,T=!1}function o(){w.rateDiealButton.enabled=!1,T=!1}function i(){w.complaintDiealButton.enabled=!1,G=!1}function a(){if(w.window.title=C.name,w.name.text=C.name,w.price.text=C.currency+" "+C.price,w.supplier.text=C.supplierName,w.address.text=C.address,w.category.text=C.subCategoriesTitles,w.distance.text=parseFloat(C.distance).toFixed(2),w.description.text=C.description,w.dealtype.text=Alloy.Globals.core.dealType[C.dealtype].title,w.complains.text=C.complainsCount,w.mapImage.image="http://maps.googleapis.com/maps/api/staticmap?center="+C.lat.replace(",",".")+","+C.lng.replace(",",".")+"8&zoom=16&size=280x180&sensor=false&markers=color:red%7Clabel:D%7C"+C.lat.replace(",",".")+","+C.lng.replace(",",".")+"%7Csize:tiny",C.vouchers<=0&&w.buttons.remove(w.getVauchersButton),C.endTime&&C.startTime){var e=Alloy.Globals.core.viewTime(Alloy.Globals.core.createTime(C.startTime)),t=Alloy.Globals.core.viewTime(Alloy.Globals.core.createTime(C.endTime));w.workTime.text=e+" - "+t}else w.scrollView.remove(w.workTime),w.scrollView.remove(w.workTimeLbl);if(C.images){C.images=JSON.parse(C.images);for(var l=0;l<C.images.length;l++){var o=Ti.UI.createImageView({image:"http://"+Ti.App.serverDomain+"/api/"+Titanium.App.ApiVersion+"/image/"+C.images[l]+Alloy.Globals.imageSizes.deal.view(),imageOriginal:"http://"+Ti.App.serverDomain+"/api/"+Titanium.App.ApiVersion+"/image/"+C.images[l]+Alloy.Globals.imageSizes.deal.original(),wihth:"180dp",height:"180dp"});o.addEventListener("click",s),w.images.addView(o)}C.images.length>0&&U.createWindow(w.images.views)}r(C.rating,C.votes),k.closeIndicator()}function s(){var e=w.images.getCurrentPage();U.openWindow(e)}function r(e,t){switch(e){case 1:N="images/rate_0.png";break;case 2:N="images/rate_2.png";break;case 3:N="images/rate_3.png";break;case 4:N="images/rate_4.png";break;case 5:N="images/rate_5.png"}w.rating.backgroundImage=N,w.ratingVoted.text=t}function n(){if(!Alloy.Globals.core.apiToken()){var e=Titanium.UI.createAlertDialog({title:L("signup_or_signin_title"),message:L("signup_or_signin_message"),buttonNames:[L("no"),L("yes")],cancel:0});return e.addEventListener("click",function(e){e.cancel!==e.index&&!0!==e.cancel&&Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabAccount)}),void e.show()}var t=Alloy.createController("home/companies/company",{id:C.supplierId,callback:function(e){w.window.close(),f&&f(e)}}).getView();t.backButtonTitle="Back to deal",Alloy.CFG.tabHome.open(t)}function d(){if(!Alloy.Globals.core.apiToken()){var e=Titanium.UI.createAlertDialog({title:L("signup_or_signin_title"),message:L("signup_or_signin_message"),buttonNames:[L("no"),L("yes")],cancel:0});return e.addEventListener("click",function(e){e.cancel!==e.index&&!0!==e.cancel&&Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabAccount)}),void e.show()}var t=Alloy.createModel("getVoucher",{DealId:C.id});k.openIndicator(),t.save({},{success:function(e,t){k.closeIndicator();var l=Titanium.UI.createAlertDialog({title:L("voucher_successfull_get"),message:"#"+t.Id,buttonNames:[L("ok"),L("email")],cancel:0});l.addEventListener("click",function(e){if(e.cancel!==e.index&&!0!==e.cancel){k.openIndicator();var l=Alloy.createModel("profile");l.fetch({success:function(e){e=e.toJSON();var l=L("name")+": "+e.firstName+" "+e.lastName;e.phone&&(l=l+"\n"+L("phone")+": "+e.phone),l=l+"\n"+L("my_voucher_code")+" "+t.Id+"\n",k.closeIndicator();var o=Ti.UI.createEmailDialog();o.subject=L("voucher_code"),o.toRecipients=[e.email],o.messageBody=l,o.open()},error:function(){k.closeIndicator()}})}}),l.show()},error:function(e,t){k.closeIndicator(),t.Message&&Alloy.Globals.core.showErrorDialog(t.Message)}})}function c(){var e=Alloy.createController("home/adverts/advertMap",{advert:C}).getView();Alloy.Globals.tabGroup.activeTab.open(e)}function u(){if(!Alloy.Globals.core.apiToken()){var e=Titanium.UI.createAlertDialog({title:L("signup_or_signin_title"),message:L("signup_or_signin_message"),buttonNames:[L("no"),L("yes")],cancel:0});return e.addEventListener("click",function(e){e.cancel!==e.index&&!0!==e.cancel&&Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabAccount)}),e.show(),void k.closeIndicator()}var t=0;Alloy.Globals.profile&&(t=Alloy.Globals.profile.id);var l=Alloy.createController("picker/rate",{callback:function(e){var l=Alloy.createModel("dealRaiting",{DealId:C.id,raiting:e,UserId:t});k.openIndicator(),l.save({},{success:function(e,t){Titanium.UI.createAlertDialog({title:"Thank you!"}).show(),k.closeIndicator(),r(t.Raiting,C.votes),C.rating=t.Raiting;try{var l=Alloy.Collections.publicDeals.where({id:t.DealId})[0];l.set("rating",t.Raiting),l.set("votes",t.votes)}catch(i){}try{var l=Alloy.Collections.homeDeals.where({id:t.DealId})[0];l.set("rating",t.Raiting),l.set("votes",t.votes)}catch(i){}try{var l=Alloy.Collections.companyDeals.where({id:t.DealId})[0];l.set("rating",t.Raiting),l.set("votes",t.votes)}catch(i){}w.ratingVoted.text=t.votes,o()},error:function(e,t){Alloy.Globals.core.showErrorDialog(t&&t.Message?L("server_"+t.Message,L("error")):L("error"))}})}}).getView();return l.backButtonTitle=L("back"),l}function y(e){e.source.enabled&&(e.source.backgroundColor=Alloy.Globals.Styles.buttonBgOnTap)}function p(e){k.openIndicator(),e.source.enabled&&(e.source.backgroundColor=Alloy.Globals.Styles.buttonBg,e.source.id&&b(e.source.id))}function b(e){var t=!1;switch(e){case"rateDiealButton":t=u(),k.closeIndicator();break;case"complaintDiealButton":if(!Alloy.Globals.core.apiToken()){var l=Titanium.UI.createAlertDialog({title:L("signup_or_signin_title"),message:L("signup_or_signin_message"),buttonNames:[L("no"),L("yes")],cancel:0});l.addEventListener("click",function(e){e.cancel!==e.index&&!0!==e.cancel&&Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabAccount)}),l.show(),k.closeIndicator();break}t=Alloy.createController("complaints/index",{id:C.id,dealWindow:function(){i()},callback:function(){Alloy.Globals.core.showErrorDialog(L("thanks"))}}).getView(),k.closeIndicator();break;case"supplierButton":t=Alloy.createController("home/companies/company",{id:C.supplierId,lat:S,lng:I,callback:function(e){w.window.close(),f&&f(e)}}).getView(),t.backButtonTitle="Back to deal",k.closeIndicator();break;case"similarDealsButton":t=Alloy.createController("home/deals/similardeals",{deal:C,lat:S,lng:I}).getView(),k.closeIndicator();break;case"allDealsButton":t=Alloy.createController("home/companies/allDeals",{id:C.supplierId,supplierName:C.supplierName,lat:S,lng:I}).getView(),k.closeIndicator();break;case"getVauchersButton":d(),k.closeIndicator();break;case"send":if(!Alloy.Globals.core.apiToken()){var l=Titanium.UI.createAlertDialog({title:L("signup_or_signin_title"),message:L("signup_or_signin_message"),buttonNames:[L("no"),L("yes")],cancel:0});l.addEventListener("click",function(e){e.cancel!==e.index&&!0!==e.cancel&&Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabAccount)}),l.show(),k.closeIndicator();break}if(C.supplierId===Alloy.Globals.profile.id){Alloy.Globals.core.showErrorDialog(L("cant_write_themselves")),k.closeIndicator();break}var o=null;Alloy.Collections.chats.fetch({success:function(){o=Alloy.Collections.chats.where({To:C.supplierId})[0],null!=o?(o=o.toJSON(),t=Alloy.createController("account/answers/answer",{id:o.ChatId,toUser:o.To,newChat:!1}).getView(),k.closeIndicator(),Alloy.CFG.tabHome.open(t)):Alloy.createModel("chat",{from:Alloy.Globals.profile.id,to:C.supplierId}).save({},{success:function(){t=Alloy.createController("account/answers/answer",{id:arguments[1],newChat:!0,toUser:C.supplierId}).getView(),k.closeIndicator(),Alloy.CFG.tabHome.open(t)},error:function(){k.closeIndicator(),Alloy.Globals.core.showErrorDialog(L("chat_open_error"))}})},error:function(){Alloy.Globals.core.showErrorDialog(L("chat_open_error")),k.closeIndicator()}});break;case"share":Alloy.Globals.tabGroup.setActiveTab(Alloy.CFG.tabShare),k.closeIndicator()}t&&Alloy.CFG.tabHome.open(t)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="home/deals/deal",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var w=this,g={},h={};w.__views.window=Ti.UI.createWindow({backgroundImage:Alloy.Globals.Styles.backgroundImage,layout:"vertical",fullscreen:"true",id:"window"}),w.__views.window&&w.addTopLevelView(w.__views.window),e?w.__views.window.addEventListener("open",e):h["$.__views.window!open!open"]=!0,w.__views.scrollView=Ti.UI.createScrollView({layout:"vertical",left:"20dp",right:"20dp",id:"scrollView"}),w.__views.window.add(w.__views.scrollView),w.__views.name=Ti.UI.createLabel({height:Ti.UI.SIZE,width:Ti.UI.FILL,textAlign:"center",color:Alloy.Globals.Styles.titleColor,font:{fontSize:"25dp",fontFamily:"OleoScriptSwashCaps-Regular"},id:"name"}),w.__views.scrollView.add(w.__views.name),w.__views.category=Ti.UI.createLabel({color:"#a1a1a1",width:"280dp",height:Ti.UI.SIZE,bottom:"10dp",left:"0dp",textAlign:"center",font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"category"}),w.__views.scrollView.add(w.__views.category);var v=[];w.__views.images=Ti.UI.createScrollableView({width:"280dp",height:"180dp",left:"0dp",bottom:"10dp",contenWidth:"180dp",borderColor:"#ccc",borderWidth:"1dp",backgroundColor:"#fff",views:v,id:"images",showPagingControl:"true"}),w.__views.scrollView.add(w.__views.images),w.__views.buttonsView=Ti.UI.createView({layout:"horizontal",width:"280dp",height:Ti.UI.SIZE,textAlign:"center",bottom:"5dp",id:"buttonsView"}),w.__views.scrollView.add(w.__views.buttonsView),w.__views.campaignRatingWrap=Ti.UI.createView({layout:"absolute",height:"30dp",bottom:"10dp",id:"campaignRatingWrap"}),w.__views.buttonsView.add(w.__views.campaignRatingWrap),w.__views.rateDiealButton=Ti.UI.createButton({width:"90dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:Alloy.Globals.Styles.smallHorButton_Right,backgroundDisabledImage:"images/gray_fill.png",disabledColor:"#ccc",id:"rateDiealButton",titleid:"rateDeal"}),w.__views.campaignRatingWrap.add(w.__views.rateDiealButton),y?w.__views.rateDiealButton.addEventListener("touchstart",y):h["$.__views.rateDiealButton!touchstart!buttonTouchStart"]=!0,p?w.__views.rateDiealButton.addEventListener("touchend",p):h["$.__views.rateDiealButton!touchend!buttonTouchEnd"]=!0,w.__views.rating=Ti.UI.createView({width:"125dp",height:"23dp",left:Alloy.Globals.Styles.campaingRating_left,right:Alloy.Globals.Styles.campaingRating_right,top:"2dp",backgroundRepeat:!1,id:"rating"}),w.__views.campaignRatingWrap.add(w.__views.rating),w.__views.ratingVoted=Ti.UI.createLabel({top:"7dp",left:Alloy.Globals.Styles.campaingRatingVoted_left,right:Alloy.Globals.Styles.campaingRatingVoted_right,font:{fontFamily:"Avenir Next Condensed",fontSize:"13dp"},color:"#a1a1a1",id:"ratingVoted"}),w.__views.campaignRatingWrap.add(w.__views.ratingVoted),w.__views.__alloyId226=Ti.UI.createView({layout:"absolute",height:"30dp",id:"__alloyId226"}),w.__views.buttonsView.add(w.__views.__alloyId226),w.__views.complaintDiealButton=Ti.UI.createButton({width:"90dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:Alloy.Globals.Styles.smallHorButton_Right,backgroundDisabledImage:"images/gray_fill.png",disabledColor:"#ccc",id:"complaintDiealButton",titleid:"complain"}),w.__views.__alloyId226.add(w.__views.complaintDiealButton),y?w.__views.complaintDiealButton.addEventListener("touchstart",y):h["$.__views.complaintDiealButton!touchstart!buttonTouchStart"]=!0,p?w.__views.complaintDiealButton.addEventListener("touchend",p):h["$.__views.complaintDiealButton!touchend!buttonTouchEnd"]=!0,w.__views.complains=Ti.UI.createLabel({width:"20dp",height:"30dp",top:Alloy.Globals.Styles.complainLabelTop,bottom:"0dp",left:Alloy.Globals.Styles.complainCountLeft,right:Alloy.Globals.Styles.complainCountRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#303030",id:"complains"}),w.__views.__alloyId226.add(w.__views.complains),w.__views.complainsLbl=Ti.UI.createLabel({width:Ti.UI.SIZE,height:"30dp",color:"#a1a1a1",left:Alloy.Globals.Styles.complainLabelLeft,right:Alloy.Globals.Styles.complainLabelRight,textAlign:"left",font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"complainsLbl",textid:"complains"}),w.__views.__alloyId226.add(w.__views.complainsLbl),w.__views.priceLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:"#a1a1a1",left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"priceLbl",textid:"price"}),w.__views.scrollView.add(w.__views.priceLbl),w.__views.price=Ti.UI.createLabel({width:"100dp",height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.priceLeft,right:Alloy.Globals.Styles.priceRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"20dp",fontFamily:"Avenir Next Condensed"},color:"#a80062",layout:"horisontal",id:"price"}),w.__views.scrollView.add(w.__views.price),w.__views.__alloyId227=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId227"}),w.__views.scrollView.add(w.__views.__alloyId227),w.__views.dealtypeLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:"#a1a1a1",left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"dealtypeLbl",textid:"dealtype"}),w.__views.scrollView.add(w.__views.dealtypeLbl),w.__views.dealtype=Ti.UI.createLabel({width:"100dp",height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.priceLeft,right:Alloy.Globals.Styles.priceRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"20dp",fontFamily:"Avenir Next Condensed"},color:"#a80062",layout:"horisontal",id:"dealtype"}),w.__views.scrollView.add(w.__views.dealtype),w.__views.__alloyId228=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId228"}),w.__views.scrollView.add(w.__views.__alloyId228),w.__views.descriptionLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:"#a1a1a1",left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"descriptionLbl",textid:"about_the_deal"}),w.__views.scrollView.add(w.__views.descriptionLbl),w.__views.description=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.priceLeft,right:Alloy.Globals.Styles.priceRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#555",id:"description"}),w.__views.scrollView.add(w.__views.description),w.__views.__alloyId229=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId229"}),w.__views.scrollView.add(w.__views.__alloyId229),w.__views.supplierLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:"#a1a1a1",left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"supplierLbl",textid:"supplier"}),w.__views.scrollView.add(w.__views.supplierLbl),w.__views.supplier=Ti.UI.createLabel({width:"100dp",height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.priceLeft,right:Alloy.Globals.Styles.priceRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"20dp",fontFamily:"Avenir Next Condensed"},color:"#00accb",layout:"horisontal",id:"supplier"}),w.__views.scrollView.add(w.__views.supplier),n?w.__views.supplier.addEventListener("click",n):h["$.__views.supplier!click!onClickSupplier"]=!0,w.__views.__alloyId230=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId230"}),w.__views.scrollView.add(w.__views.__alloyId230),w.__views.addressLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:"#a1a1a1",left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"addressLbl",textid:"address"}),w.__views.scrollView.add(w.__views.addressLbl),w.__views.address=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.priceLeft,right:Alloy.Globals.Styles.priceRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#00accb",id:"address"}),w.__views.scrollView.add(w.__views.address),c?w.__views.address.addEventListener("click",c):h["$.__views.address!click!onClickAddress"]=!0,w.__views.__alloyId231=Ti.UI.createView({height:"1dp",backgroundColor:"#d9d9d9",id:"__alloyId231"}),w.__views.scrollView.add(w.__views.__alloyId231),w.__views.distanceLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:"#a1a1a1",left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"distanceLbl",textid:"distance"}),w.__views.scrollView.add(w.__views.distanceLbl),w.__views.distance=Ti.UI.createLabel({width:"100dp",height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.priceLeft,right:Alloy.Globals.Styles.priceRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"20dp",fontFamily:"Avenir Next Condensed"},color:"#a80062",layout:"horisontal",id:"distance"}),w.__views.scrollView.add(w.__views.distance),w.__views.mapImage=Ti.UI.createImageView({bottom:"10dp",width:"280dp",id:"mapImage",image:""}),w.__views.scrollView.add(w.__views.mapImage),c?w.__views.mapImage.addEventListener("click",c):h["$.__views.mapImage!click!onClickAddress"]=!0,w.__views.workTimeLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:"#a1a1a1",left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},bottom:"0dp",id:"workTimeLbl",textid:"work_time"}),w.__views.scrollView.add(w.__views.workTimeLbl),w.__views.workTime=Ti.UI.createLabel({width:Alloy.Globals.Styles.inputWidth,height:Ti.UI.SIZE,top:"-28dp",bottom:"0dp",left:Alloy.Globals.Styles.priceLeft,right:Alloy.Globals.Styles.priceRight,textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},color:"#555",id:"workTime"}),w.__views.scrollView.add(w.__views.workTime),w.__views.buttons=Ti.UI.createView({layout:"horizontal",width:"280dp",height:Ti.UI.SIZE,textAlign:"center",bottom:"5dp",id:"buttons"}),w.__views.scrollView.add(w.__views.buttons),w.__views.supplierButton=Ti.UI.createButton({width:"135dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:"10dp",id:"supplierButton",titleid:"supplier"}),w.__views.buttons.add(w.__views.supplierButton),y?w.__views.supplierButton.addEventListener("touchstart",y):h["$.__views.supplierButton!touchstart!buttonTouchStart"]=!0,p?w.__views.supplierButton.addEventListener("touchend",p):h["$.__views.supplierButton!touchend!buttonTouchEnd"]=!0,w.__views.similarDealsButton=Ti.UI.createButton({width:"135dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:Alloy.Globals.Styles.smallHorButton_Right,id:"similarDealsButton",titleid:"similardeals"}),w.__views.buttons.add(w.__views.similarDealsButton),y?w.__views.similarDealsButton.addEventListener("touchstart",y):h["$.__views.similarDealsButton!touchstart!buttonTouchStart"]=!0,p?w.__views.similarDealsButton.addEventListener("touchend",p):h["$.__views.similarDealsButton!touchend!buttonTouchEnd"]=!0,w.__views.allDealsButton=Ti.UI.createButton({width:"280dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:Alloy.Globals.Styles.smallHorButton_Right,top:"10dp",id:"allDealsButton",titleid:"allDealsFromSupplier"}),w.__views.buttons.add(w.__views.allDealsButton),y?w.__views.allDealsButton.addEventListener("touchstart",y):h["$.__views.allDealsButton!touchstart!buttonTouchStart"]=!0,p?w.__views.allDealsButton.addEventListener("touchend",p):h["$.__views.allDealsButton!touchend!buttonTouchEnd"]=!0,w.__views.getVauchersButton=Ti.UI.createButton({width:"280dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:Alloy.Globals.Styles.smallHorButton_Right,top:"10dp",id:"getVauchersButton",titleid:"getVauchers"}),w.__views.buttons.add(w.__views.getVauchersButton),y?w.__views.getVauchersButton.addEventListener("touchstart",y):h["$.__views.getVauchersButton!touchstart!buttonTouchStart"]=!0,p?w.__views.getVauchersButton.addEventListener("touchend",p):h["$.__views.getVauchersButton!touchend!buttonTouchEnd"]=!0,w.__views.send=Ti.UI.createButton({width:"280dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:Alloy.Globals.Styles.smallHorButton_Right,top:"10dp",id:"send",titleid:"contact_supplier"}),w.__views.buttons.add(w.__views.send),y?w.__views.send.addEventListener("touchstart",y):h["$.__views.send!touchstart!buttonTouchStart"]=!0,p?w.__views.send.addEventListener("touchend",p):h["$.__views.send!touchend!buttonTouchEnd"]=!0,w.__views.share=Ti.UI.createButton({width:"280dp",height:"30dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"16dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,left:Alloy.Globals.Styles.smallHorButton_Left,right:Alloy.Globals.Styles.smallHorButton_Right,top:"10dp",id:"share",titleid:"tab_share"}),w.__views.buttons.add(w.__views.share),y?w.__views.share.addEventListener("touchstart",y):h["$.__views.share!touchstart!buttonTouchStart"]=!0,p?w.__views.share.addEventListener("touchend",p):h["$.__views.share!touchend!buttonTouchEnd"]=!0,w.__views.__alloyId232=Ti.UI.createView({height:"20dp",width:Ti.UI.FILL,id:"__alloyId232"}),w.__views.scrollView.add(w.__views.__alloyId232),g.destroy=function(){},_.extend(w,w.__views);var f=arguments[0].callback||null,m=arguments[0].accountdeal||null,A=arguments[0].id||null,S=arguments[0].lat||null,I=arguments[0].lng||null,T=!0,G=!0;if(m){var x=Ti.UI.createButton({title:L("edit")});w.window.setRightNavButton(x),x.addEventListener("click",function(){var e=Alloy.createController("add/deal",{dealId:C.id,callback:function(){w.window.close()},tab:Alloy.CFG.tabAccount}).getView();Alloy.CFG.tabAccount.open(e)})}var C,k=Alloy.Globals.indicator,E=!1,U={window:!1,view:!1,openWindow:function(e){var t=this;t.window.open(),t.view.setCurrentPage(e)},createWindow:function(e){var t=this;t.window=Ti.UI.createWindow({width:"100%",height:"100%",backgroundColor:"#f0f0f0",orientationModes:[Ti.UI.PORTRAIT,Ti.UI.LANDSCAPE_LEFT,Ti.UI.LANDSCAPE_RIGHT]});var l=Ti.UI.createButton({title:"X",width:"30dp",height:"30dp",right:"5dp",top:"5dp",zIndex:10,backgroundColor:Alloy.Globals.Styles.buttonBg,color:"#fff"});l.addEventListener("click",function(){t.window.close()});for(var o=[],i=0;i<e.length;i++){var a=e[i],s=Ti.UI.createImageView({image:a.imageOriginal});o.push(s)}t.view=Ti.UI.createScrollableView({showPagingControl:!0,views:o}),t.window.add(t.view),t.window.add(l)}},N="images/rate_0.png";m&&(w.scrollView.remove(w.buttons),w.scrollView.remove(w.supplier),w.scrollView.remove(w.supplierLbl),w.rateDiealButton.hide(),w.complaintDiealButton.hide(),w.addClass(w.rating,"ratingCenter"),w.addClass(w.ratingVoted,"ratingVotedCenter"),w.addClass(w.complains,"complainsCountCenter"),w.addClass(w.complainsLbl,"complainsLabelCenter")),h["$.__views.window!open!open"]&&w.__views.window.addEventListener("open",e),h["$.__views.rateDiealButton!touchstart!buttonTouchStart"]&&w.__views.rateDiealButton.addEventListener("touchstart",y),h["$.__views.rateDiealButton!touchend!buttonTouchEnd"]&&w.__views.rateDiealButton.addEventListener("touchend",p),h["$.__views.complaintDiealButton!touchstart!buttonTouchStart"]&&w.__views.complaintDiealButton.addEventListener("touchstart",y),h["$.__views.complaintDiealButton!touchend!buttonTouchEnd"]&&w.__views.complaintDiealButton.addEventListener("touchend",p),h["$.__views.supplier!click!onClickSupplier"]&&w.__views.supplier.addEventListener("click",n),h["$.__views.address!click!onClickAddress"]&&w.__views.address.addEventListener("click",c),h["$.__views.mapImage!click!onClickAddress"]&&w.__views.mapImage.addEventListener("click",c),h["$.__views.supplierButton!touchstart!buttonTouchStart"]&&w.__views.supplierButton.addEventListener("touchstart",y),h["$.__views.supplierButton!touchend!buttonTouchEnd"]&&w.__views.supplierButton.addEventListener("touchend",p),h["$.__views.similarDealsButton!touchstart!buttonTouchStart"]&&w.__views.similarDealsButton.addEventListener("touchstart",y),h["$.__views.similarDealsButton!touchend!buttonTouchEnd"]&&w.__views.similarDealsButton.addEventListener("touchend",p),h["$.__views.allDealsButton!touchstart!buttonTouchStart"]&&w.__views.allDealsButton.addEventListener("touchstart",y),h["$.__views.allDealsButton!touchend!buttonTouchEnd"]&&w.__views.allDealsButton.addEventListener("touchend",p),h["$.__views.getVauchersButton!touchstart!buttonTouchStart"]&&w.__views.getVauchersButton.addEventListener("touchstart",y),h["$.__views.getVauchersButton!touchend!buttonTouchEnd"]&&w.__views.getVauchersButton.addEventListener("touchend",p),h["$.__views.send!touchstart!buttonTouchStart"]&&w.__views.send.addEventListener("touchstart",y),h["$.__views.send!touchend!buttonTouchEnd"]&&w.__views.send.addEventListener("touchend",p),h["$.__views.share!touchstart!buttonTouchStart"]&&w.__views.share.addEventListener("touchstart",y),h["$.__views.share!touchend!buttonTouchEnd"]&&w.__views.share.addEventListener("touchend",p),_.extend(w,g)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;