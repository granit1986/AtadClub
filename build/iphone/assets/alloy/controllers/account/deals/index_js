function __processArg(e,t){var o=null;return e&&(o=e[t]||null,delete e[t]),o}function Controller(){function e(){a.openIndicator(),Ti.App.addEventListener("account:updateDeals",o),o()}function t(){Ti.App.removeEventListener("account:updateDeals",o),Alloy.Collections.deals.reset()}function o(){if(Alloy.Globals.core.apiToken()){var e=new Benchmark;Alloy.Collections.deals.fetch({data:{lng:Ti.Platform.locale},success:function(){Alloy.Globals.core.createRows(Alloy.Collections.deals,i,r.deals,"account/deals/row"),Ti.API.info("Fetch time - "+e.test()+" ms"),a.closeIndicator()},error:function(){a.closeIndicator()}})}}function i(e){var t=e.toJSON();return t.price=t.currency+" "+t.price,t.images=t.images&&t.images.length>0?JSON.parse(t.images):[],t.images.length>0&&(t.image="http://"+Ti.App.serverDomain+"/api/"+Titanium.App.ApiVersion+"/image/"+t.images[0]+Alloy.Globals.imageSizes.deal.row()),t.statusLbl=L(t.active?"active":"not_active"),t}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="account/deals/index",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var r=this,n={},l={};r.__views.window=Ti.UI.createWindow({backgroundImage:"images/background.png",layout:"vertical",id:"window",fullscreen:"true",titleid:"my_deals"}),r.__views.window&&r.addTopLevelView(r.__views.window),e?r.__views.window.addEventListener("open",e):l["$.__views.window!open!open"]=!0,t?r.__views.window.addEventListener("close",t):l["$.__views.window!close!close"]=!0,r.__views.deals=Ti.UI.createTableView({backgroundColor:"#00ffffff",id:"deals"}),r.__views.window.add(r.__views.deals),n.destroy=function(){},_.extend(r,r.__views);var a=Alloy.Globals.indicator,s=Ti.UI.createButton({titleid:"add"});s.addEventListener("click",function(){var e=Alloy.createController("add/deal",{tab:Alloy.CFG.tabAccount,enterFromAccount:!0}).getView();Alloy.CFG.tabAccount.open(e)}),r.window.rightNavButton=s,l["$.__views.window!open!open"]&&r.__views.window.addEventListener("open",e),l["$.__views.window!close!close"]&&r.__views.window.addEventListener("close",t),_.extend(r,n)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;