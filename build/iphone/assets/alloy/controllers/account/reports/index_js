function __processArg(e,t){var o=null;return e&&(o=e[t]||null,delete e[t]),o}function Controller(){function e(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBgOnTap}function t(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBg;var t=e.source.id;switch(t){case"deals":o();break;case"send":l()}}function o(){var e=Alloy.createController("account/reports/deals",{callback:function(){var e=Alloy.Collections.selectedDeals;if(e){r.selectedCategories.text="";for(var t=0;t<e.length;t++){var o=e[t];r.selectedCategories.text+=""===r.selectedCategories.text?o.title:", "+o.title}}}}).getView();Alloy.Globals.tabGroup.activeTab.open(e)}function l(){if(0==Alloy.Collections.selectedDeals.length)return void Alloy.Globals.core.showErrorDialog(L("choose_deals"));p.openIndicator();for(var e=[],t=0;t<Alloy.Collections.selectedDeals.length;t++){var o=Alloy.Collections.selectedDeals[t];e.push(o.id)}var l=Alloy.createModel("report",{items:e,from:c,to:u});l.localValidate(i)?l.save({},{success:function(e,t){p.closeIndicator(),Alloy.Globals.core.showErrorDialog(L(t))},error:function(e){p.closeIndicator(),e&&e.Message&&Alloy.Globals.core.showErrorDialog(L(e.Message))}}):p.closeIndicator()}function i(e){Alloy.Globals.core.showError(e)}function s(){var e=Alloy.createController("picker/date",{minDate:new Date(2014,7,1,0,0,0,0),callback:function(e,t){c=e,r.startDate.value=e.toLocaleDateString(),t&&r.pickerWrap.removeAllChildren()}}).getView();r.pickerWrap.removeAllChildren(),r.pickerWrap.add(e)}function a(){var e=Alloy.createController("picker/date",{minDate:new Date(2014,7,1,0,0,0,0),callback:function(e,t){u=e,r.endDate.value=e.toLocaleDateString(),t&&r.pickerWrap.removeAllChildren()}}).getView();r.pickerWrap.removeAllChildren(),r.pickerWrap.add(e)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="account/reports/index",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var r=this,n={},d={};r.__views.window=Ti.UI.createWindow({backgroundImage:Alloy.Globals.Styles.backgroundImage,layout:"absolute",id:"window",titleid:"best_deals"}),r.__views.window&&r.addTopLevelView(r.__views.window),r.__views.__alloyId107=Ti.UI.createScrollView({layout:"vertical",left:"20dp",right:"20dp",id:"__alloyId107"}),r.__views.window.add(r.__views.__alloyId107),r.__views.__alloyId108=Ti.UI.createView({height:"20dp",width:Ti.UI.FILL,id:"__alloyId108"}),r.__views.__alloyId107.add(r.__views.__alloyId108),r.__views.__alloyId109=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},textid:"deals",id:"__alloyId109"}),r.__views.__alloyId107.add(r.__views.__alloyId109),r.__views.deals=Ti.UI.createButton({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,textAlign:"left",borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,title:"",id:"deals"}),r.__views.__alloyId107.add(r.__views.deals),o?r.__views.deals.addEventListener("click",o):d["$.__views.deals!click!openDeals"]=!0,r.__views.__alloyId110=Ti.UI.createLabel({width:Ti.UI.SIZE,left:"5dp",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,font:{fontSize:"15dp",fontFamily:"Arial"},textid:"select_category",id:"__alloyId110"}),r.__views.deals.add(r.__views.__alloyId110),r.__views.selectedCategories=Ti.UI.createLabel({height:"20dp",left:"52dp",right:"15dp",top:"7dp",color:"#aaa",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,font:{fontSize:"12dp",fontFamily:"Arial"},id:"selectedCategories"}),r.__views.deals.add(r.__views.selectedCategories),r.__views.__alloyId111=Ti.UI.createLabel({width:"20dp",height:"20dp",right:"5dp",top:"5dp",backgroundImage:"images/icon_listItem.png",backgroundRepeat:!1,id:"__alloyId111"}),r.__views.deals.add(r.__views.__alloyId111),r.__views.__alloyId112=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},textid:"start_date",id:"__alloyId112"}),r.__views.__alloyId107.add(r.__views.__alloyId112),r.__views.startDate=Ti.UI.createTextField({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"startDate",enabled:"false"}),r.__views.__alloyId107.add(r.__views.startDate),s?r.__views.startDate.addEventListener("click",s):d["$.__views.startDate!click!setStartDate"]=!0,r.__views.__alloyId113=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},textid:"finish_date",id:"__alloyId113"}),r.__views.__alloyId107.add(r.__views.__alloyId113),r.__views.endDate=Ti.UI.createTextField({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"endDate",enabled:"false"}),r.__views.__alloyId107.add(r.__views.endDate),a?r.__views.endDate.addEventListener("click",a):d["$.__views.endDate!click!setEndDate"]=!0,r.__views.__alloyId114=Ti.UI.createView({height:"20dp",width:Ti.UI.FILL,id:"__alloyId114"}),r.__views.__alloyId107.add(r.__views.__alloyId114),r.__views.send=Ti.UI.createButton({width:"180dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"send",titleid:"send_to_email"}),r.__views.__alloyId107.add(r.__views.send),e?r.__views.send.addEventListener("touchstart",e):d["$.__views.send!touchstart!buttonTouchStart"]=!0,t?r.__views.send.addEventListener("touchend",t):d["$.__views.send!touchend!buttonTouchEnd"]=!0,r.__views.pickerWrap=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,bottom:"0",id:"pickerWrap"}),r.__views.window.add(r.__views.pickerWrap),n.destroy=function(){},_.extend(r,r.__views);var c="",u="";Alloy.Collections.selectedDeals=[];var p=Alloy.Globals.indicator;d["$.__views.deals!click!openDeals"]&&r.__views.deals.addEventListener("click",o),d["$.__views.startDate!click!setStartDate"]&&r.__views.startDate.addEventListener("click",s),d["$.__views.endDate!click!setEndDate"]&&r.__views.endDate.addEventListener("click",a),d["$.__views.send!touchstart!buttonTouchStart"]&&r.__views.send.addEventListener("touchstart",e),d["$.__views.send!touchend!buttonTouchEnd"]&&r.__views.send.addEventListener("touchend",t),_.extend(r,n)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;