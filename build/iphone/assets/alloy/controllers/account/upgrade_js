function __processArg(e,t){var l=null;return e&&(l=e[t]||null,delete e[t]),l}function Controller(){function e(){var e=Alloy.createModel("payment",{status:n.statusCode,paymentSumm:n.priceText});e.save({},{success:function(){Alloy.Globals.chat.connected&&Alloy.Globals.chat.source.close(),Alloy.Globals.core.showErrorDialog(p[n.statusCode-1]),Ti.App.fireEvent("account:updateProfile"),a.window.close()}})}function t(e,t,l){e.downloadable&&Ti.API.info("Purchasing a product that is downloadable"),d.openIndicator(),n.statusCode=l,n.priceText=t,n.selectedProduct.buy=!1,n.selectedProduct.name=e.identifier,n.selectedProduct.error=!1,n.Storekit.purchase({product:e,quantity:1})}function l(e,l,o){var r=Ti.UI.createButton({height:"56dp",layout:"vertical",top:"20dp",width:"80%",borderWidth:"2dp",borderColor:"#00a99d",backgroundColor:"#fff"}),n=Ti.UI.createLabel({text:e.title,color:"#00a99d",top:"5dp",font:{fontSize:"16dp",fontFamily:"Avenir Next Condensed"}}),d=Ti.UI.createLabel({text:e.formattedPrice,color:"#a80062",bottom:"10dp",top:"5dp",font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"}}),c=Ti.UI.createView({width:Ti.UI.FILL,height:"1dp",top:0,left:0,backgroundColor:"#ccc"});r.add(n),r.add(d),0!=h&&r.add(c),r.price=l,r.code=o,r.addEventListener("click",function(l){l.source.parent.price&&l.source.parent.code&&t(e,l.source.parent.price,l.source.parent.code),l.source.price&&l.source.code&&t(e,l.source.price,l.source.code)}),r.addEventListener("touchstart",i),r.addEventListener("touchend",s),a.scroll.add(r),h++}function o(e){var t=Ti.UI.createLabel({text:e,textAlign:Alloy.Globals.Styles.titleLbl_textAlign,top:"0",width:"80%"});a.scrollDescription.add(t)}function i(e){e.source.backgroundColor="rgba(150,150,150, 1)"}function s(e){e.source.backgroundColor="#fff"}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="account/upgrade",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var a=this,r={};a.__views.window=Ti.UI.createWindow({backgroundImage:Alloy.Globals.Styles.backgroundImage,layout:"vertical",id:"window",titleid:"upgrade_account"}),a.__views.window&&a.addTopLevelView(a.__views.window),a.__views.scroll=Ti.UI.createView({left:"20dp",right:"20dp",height:"180dp",id:"scroll",layout:"vertical"}),a.__views.window.add(a.__views.scroll),a.__views.scrollDescription=Ti.UI.createView({left:"20dp",right:"20dp",id:"scrollDescription"}),a.__views.window.add(a.__views.scrollDescription),r.destroy=function(){},_.extend(a,a.__views);var n=Alloy.Globals.store;n.create();var d=Alloy.Globals.indicator,c=arguments[0].buySilverDeals||!1,u=arguments[0].buyGoldDeals||!1,y=arguments[0].buyAdverts||!1,p=[L("buing_silver_month"),L("buing_silver_year"),L("buing_gold_private_month"),L("buing_gold_private_year"),L("buing_gold_business_month"),L("buing_gold_business_year")];n.purchaseCompleteCallback=e;var h=0;n.Storekit.canMakePayments?(y&&(n.requestProduct("atadclub.goldprivatemonth",function(e){n.statusCode=3,n.priceText=e.formattedPrice,l(e,n.priceText,n.statusCode)}),n.requestProduct("atadclub.goldforprivateyear",function(e){n.statusCode=4,n.priceText=e.formattedPrice,l(e,n.priceText,n.statusCode)}),o(L("description_goldPrivate"))),u&&(n.requestProduct("atadclub.goldbusiness",function(e){n.statusCode=5,n.priceText=e.formattedPrice,l(e,n.priceText,n.statusCode)}),n.requestProduct("atadclub.goldbusinessyear",function(e){n.statusCode=6,n.priceText=e.formattedPrice,l(e,n.priceText,n.statusCode)}),o(L("description_goldBusiness"))),c&&(n.requestProduct("atadclub.silverbusinessmonth",function(e){n.statusCode=1,n.priceText=e.formattedPrice,l(e,n.priceText,n.statusCode)}),n.requestProduct("atadclub.silverbusinessyear",function(e){n.statusCode=2,n.priceText=e.formattedPrice,l(e,n.priceText,n.statusCode)}),o(L("description_silver")))):Alloy.Globals.core.showErrorDialog("This device cannot make purchases!"),_.extend(a,r)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;