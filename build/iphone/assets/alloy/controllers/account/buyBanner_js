function __processArg(e,t){var o=null;return e&&(o=e[t]||null,delete e[t]),o}function Controller(){function e(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBgOnTap}function t(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBg,"changeImage"==e.source.id?s():"sendBtn"==e.source.id?r():"deleteImage"==e.source.id&&c()}function o(e){i(e)}function i(e){e.source.id!==u.country.id&&u.country.blur(),e.source.id!==u.city.id&&u.city.blur(),e.source.id!==u.street.id&&u.street.blur(),e.source.id!==u.house.id&&u.house.blur()}function n(e){i(e)}function r(){if(""===u.country.value.trim())return void Alloy.Globals.core.showErrorDialog(L("country_require"));if(""===u.city.value.trim())return void Alloy.Globals.core.showErrorDialog(L("city_require"));if(!p)return void Alloy.Globals.core.showErrorDialog(L("image_require"));var e="Country: "+u.country.value+"\nCity: "+u.city.value+"\n";if(""!==u.street.value.trim()&&(e=e+"Street: "+u.street.value+"\n"),""!==u.house.value.trim()&&(e=e+"House: "+u.house.value+"\n"),p&&imageUpdated){Alloy.Globals.upload;var t=[],o=1,i=400,n=p.height,r=p.width,s=Ti.UI.createImageView({image:p,width:r,height:n});n>r?(o=r/n,s.height=i,s.width=i*o):(o=n/r,s.width=i,s.height=i*o),p=s.toImage(),t.push(p),g.openBar();var l=Ti.Network.createHTTPClient({timeout:36e5});l.onsendstream=function(e){g.setBarValue(e.progress),Ti.API.info("progress - "+e.progress)},l.onerror=function(){g.closeBar()},l.onload=function(){g.setBarValue(1),g.closeBar(),a()},l.open("POST","http://"+Titanium.App.serverDomain+"/api/"+Titanium.App.ApiVersion+"/"+Alloy.Globals.core.apiToken()+"/banners");var d={message:e,file_0:p};l.send(d)}}function a(){Alloy.Globals.core.showErrorDialog(L("request_send")),u.window.close()}function s(){m.show()}function l(){Titanium.Media.openPhotoGallery({success:function(e){e.mediaType==Titanium.Media.MEDIA_TYPE_PHOTO&&(p=e.media,u.imageView.image=p,u.deleteImage.visible=!0,u.imageView.height=Ti.UI.SIZE,u.imageView.bottom="10dp",u.imageView.visible=!0,imageUpdated=!0)}})}function d(){Titanium.Media.showCamera({success:function(e){e.mediaType==Titanium.Media.MEDIA_TYPE_PHOTO&&(p=e.media,u.imageView.image=p,u.deleteImage.visible=!0,u.imageView.visible=!0,u.imageView.height=Ti.UI.SIZE,u.imageView.bottom="10dp",imageUpdated=!0)},cancel:function(){},error:function(){}})}function c(){p=!1,imageUpdated=!1,u.imageView.image=null,u.imageView.visible=!1,u.imageView.height="0",u.imageView.bottom="0",u.deleteImage.visible=!1}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="account/buyBanner",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var u=this,h={},f={};u.__views.window=Ti.UI.createWindow({backgroundImage:Alloy.Globals.Styles.backgroundImage,layout:"absolute",id:"window",fullscreen:"true",titleid:"buy_advertisement"}),u.__views.window&&u.addTopLevelView(u.__views.window),o?u.__views.window.addEventListener("click",o):f["$.__views.window!click!blur"]=!0,u.__views.__alloyId19=Ti.UI.createScrollView({layout:"vertical",left:"20dp",right:"20dp",top:"0",id:"__alloyId19"}),u.__views.window.add(u.__views.__alloyId19),u.__views.__alloyId20=Ti.UI.createLabel({height:"80dp",width:Ti.UI.FILL,textAlign:"center",color:Alloy.Globals.Styles.titleColor,font:{fontSize:"25dp",fontFamily:"OleoScriptSwashCaps-Regular"},textid:"buyBanner_title",id:"__alloyId20"}),u.__views.__alloyId19.add(u.__views.__alloyId20),u.__views.countryLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"countryLbl",textid:"country"}),u.__views.__alloyId19.add(u.__views.countryLbl),u.__views.country=Ti.UI.createTextField({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"country"}),u.__views.__alloyId19.add(u.__views.country),n?u.__views.country.addEventListener("focus",n):f["$.__views.country!focus!focus"]=!0,u.__views.cityLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"cityLbl",textid:"city"}),u.__views.__alloyId19.add(u.__views.cityLbl),u.__views.city=Ti.UI.createTextField({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"city"}),u.__views.__alloyId19.add(u.__views.city),n?u.__views.city.addEventListener("focus",n):f["$.__views.city!focus!focus"]=!0,u.__views.streetLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"streetLbl",textid:"street"}),u.__views.__alloyId19.add(u.__views.streetLbl),u.__views.street=Ti.UI.createTextField({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"street"}),u.__views.__alloyId19.add(u.__views.street),n?u.__views.street.addEventListener("focus",n):f["$.__views.street!focus!focus"]=!0,u.__views.houseLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"houseLbl",textid:"house"}),u.__views.__alloyId19.add(u.__views.houseLbl),u.__views.house=Ti.UI.createTextField({width:Alloy.Globals.Styles.inputWidth,height:Alloy.Globals.Styles.inputHeight,top:Alloy.Globals.Styles.inputUp,bottom:"10dp",left:Alloy.Globals.Styles.inputLeft,borderColor:"#ccc",borderStyle:1,borderWidth:"1dp",textAlign:Alloy.Globals.Styles.inputTextAlign,font:{fontSize:"15dp",fontFamily:"Arial"},backgroundColor:"#fff",color:Alloy.Globals.Styles.inputColor,id:"house"}),u.__views.__alloyId19.add(u.__views.house),n?u.__views.house.addEventListener("focus",n):f["$.__views.house!focus!focus"]=!0,u.__views.imageLbl=Ti.UI.createLabel({width:Alloy.Globals.Styles.labelWidth,height:Alloy.Globals.Styles.labelHeight,color:Alloy.Globals.Styles.labelColor,left:Alloy.Globals.Styles.labelLeft,right:Alloy.Globals.Styles.labelRight,textAlign:Alloy.Globals.Styles.labelTextAlign,font:{fontSize:"17dp",fontFamily:"Avenir Next Condensed"},id:"imageLbl",textid:"image"}),u.__views.__alloyId19.add(u.__views.imageLbl),u.__views.imageView=Ti.UI.createImageView({width:Alloy.Globals.Styles.inputWidth,bottom:"0",top:Alloy.Globals.Styles.inputUp,left:Alloy.Globals.Styles.inputLeft,id:"imageView",height:"0",visible:"false"}),u.__views.__alloyId19.add(u.__views.imageView),u.__views.changeImage=Ti.UI.createButton({width:"100dp",height:Alloy.Globals.Styles.inputHeight,left:Alloy.Globals.Styles.inputLeft,style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"17dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"changeImage",titleid:"add"}),u.__views.__alloyId19.add(u.__views.changeImage),e?u.__views.changeImage.addEventListener("touchstart",e):f["$.__views.changeImage!touchstart!buttonTouchStart"]=!0,t?u.__views.changeImage.addEventListener("touchend",t):f["$.__views.changeImage!touchend!buttonTouchEnd"]=!0,u.__views.deleteImage=Ti.UI.createButton({width:"30dp",height:"30dp",bottom:"10dp",top:Alloy.Globals.Styles.inputUp,left:Alloy.Globals.Styles.inputLeft,style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,backgroundImage:"images/icon_delete.png",backgroundRepeat:!1,id:"deleteImage",visible:"false"}),u.__views.__alloyId19.add(u.__views.deleteImage),e?u.__views.deleteImage.addEventListener("touchstart",e):f["$.__views.deleteImage!touchstart!buttonTouchStart"]=!0,t?u.__views.deleteImage.addEventListener("touchend",t):f["$.__views.deleteImage!touchend!buttonTouchEnd"]=!0,u.__views.sendBtn=Ti.UI.createButton({width:"120dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"sendBtn",titleid:"send"}),u.__views.__alloyId19.add(u.__views.sendBtn),e?u.__views.sendBtn.addEventListener("touchstart",e):f["$.__views.sendBtn!touchstart!buttonTouchStart"]=!0,t?u.__views.sendBtn.addEventListener("touchend",t):f["$.__views.sendBtn!touchend!buttonTouchEnd"]=!0,u.__views.__alloyId21=Ti.UI.createLabel({top:"0",left:"0",right:"0",color:"#555",textAlign:Alloy.Globals.Styles.titleLbl_textAlign,font:{fontSize:"15dp",fontFamily:"Avenir Next Condensed"},textid:"buy_banner_text",id:"__alloyId21"}),u.__views.__alloyId19.add(u.__views.__alloyId21),u.__views.__alloyId22=Ti.UI.createView({height:"20dp",width:Ti.UI.FILL,id:"__alloyId22"}),u.__views.__alloyId19.add(u.__views.__alloyId22),u.__views.pickerWrap=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,bottom:"0",id:"pickerWrap"}),u.__views.window.add(u.__views.pickerWrap),h.destroy=function(){},_.extend(u,u.__views);var p=!1,g=Alloy.Globals.progress;Alloy.Globals.indicator;var y={options:["Make Photo","Choose Photo","Cancel"],cancel:2},m=Titanium.UI.createOptionDialog(y);m.addEventListener("click",function(e){0==e.index&&d(),1==e.index&&l()}),f["$.__views.window!click!blur"]&&u.__views.window.addEventListener("click",o),f["$.__views.country!focus!focus"]&&u.__views.country.addEventListener("focus",n),f["$.__views.city!focus!focus"]&&u.__views.city.addEventListener("focus",n),f["$.__views.street!focus!focus"]&&u.__views.street.addEventListener("focus",n),f["$.__views.house!focus!focus"]&&u.__views.house.addEventListener("focus",n),f["$.__views.changeImage!touchstart!buttonTouchStart"]&&u.__views.changeImage.addEventListener("touchstart",e),f["$.__views.changeImage!touchend!buttonTouchEnd"]&&u.__views.changeImage.addEventListener("touchend",t),f["$.__views.deleteImage!touchstart!buttonTouchStart"]&&u.__views.deleteImage.addEventListener("touchstart",e),f["$.__views.deleteImage!touchend!buttonTouchEnd"]&&u.__views.deleteImage.addEventListener("touchend",t),f["$.__views.sendBtn!touchstart!buttonTouchStart"]&&u.__views.sendBtn.addEventListener("touchstart",e),f["$.__views.sendBtn!touchend!buttonTouchEnd"]&&u.__views.sendBtn.addEventListener("touchend",t),_.extend(u,h)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;