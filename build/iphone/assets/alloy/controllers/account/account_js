function __processArg(e,t){var n=null;return e&&(n=e[t]||null,delete e[t]),n}function Controller(){function e(e){e.source.backgroundColor=Alloy.Globals.Styles.buttonBgOnTap}function t(e){l.openIndicator(),e.source.backgroundColor=Alloy.Globals.Styles.buttonBg,e.source.id&&n(e.source.id)}function n(e){var t;switch(e){case"profile":t=Alloy.createController("account/profile").getView();break;case"supplier":t=Alloy.createController("account/company",{callback:function(e){e&&Alloy.CFG.tabAccount.open(Alloy.createController("account/products/index",{alert:e}).getView())}}).getView();break;case"blackList":t=Alloy.createController("account/blackList/index").getView();break;case"adverts":t=Alloy.createController("account/adverts/index").getView();break;case"deals":if(!Alloy.Globals.profile||!Alloy.Globals.profile.supplier)return Alloy.Globals.core.showErrorDialog(L("should_be_company_message")),void l.closeIndicator();t=Alloy.createController("account/deals/index").getView();break;case"products":if(!Alloy.Globals.profile||!Alloy.Globals.profile.supplier)return Alloy.Globals.core.showErrorDialog(L("should_be_company_message")),void l.closeIndicator();t=Alloy.createController("account/products/index").getView();break;case"offers":t=Alloy.createController("account/offers/index").getView();break;case"answers":t=Alloy.createController("account/answers/index").getView();break;case"reports":if(!Alloy.Globals.profile||!Alloy.Globals.profile.supplier)return Alloy.Globals.core.showErrorDialog(L("should_be_company_message")),void l.closeIndicator();var n=Alloy.createModel("report");n.fetch({success:function(){t=Alloy.createController("account/reports/index").getView(),Alloy.CFG.tabAccount.open(t)},error:function(e,t){if(t&&t.Message&&t.restrict){var n=Titanium.UI.createAlertDialog({title:L("upgrade_membership"),message:L(t.Message),buttonNames:[L("upgrade"),L("OK")]});n.addEventListener("click",function(e){if(!e.index){var t=Alloy.createController("account/upgradeSelect").getView();Alloy.Globals.tabGroup.activeTab.open(t)}}),n.show()}}});break;case"buyBanner":t=Alloy.createController("account/buyBanner").getView()}t&&Alloy.CFG.tabAccount.open(t),l.closeIndicator()}function r(){if(Alloy.Globals.profile){var e=Alloy.createModel("signout",{appInstallId:Alloy.Globals.core.installId,userId:Alloy.Globals.profile.id});e.save({success:function(){Ti.API.info("destroyed")}}),Alloy.CFG.tabAccount.title=L("tab_signin")}Ti.Facebook.logout(),Alloy.Globals.profile=null,Alloy.Globals.core.apiToken(!1),Alloy.Globals.chat.source&&Alloy.Globals.chat.source.close(),Ti.App.fireEvent("account:showSignIn")}function i(){var e=Alloy.createModel("counts");e.fetch({success:function(){e=e.toJSON(),e.MessagesCount>0?(o.answers_badge.text=e.MessagesCount,o.answers_badge.visible=!0,o.answers_badge.width=e.MessagesCount<10?20:"auto"):0===e.MessagesCount&&(o.answers_badge.text="",o.answers_badge.visible=!1),e.OffersCount>0?(o.offers_badge.text=e.OffersCount,o.offers_badge.visible=!0,o.offers_badge.width=e.OffersCount<10?20:"auto"):0===e.OffersCount&&(o.offers_badge.text="",o.offers_badge.visible=!1)}}),Ti.API.info("Counts refreshed")}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="account/account",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var o=this,s={},a={};o.__views.account=Ti.UI.createScrollView({layout:"vertical",left:"20dp",right:"20dp",id:"account"}),o.__views.account&&o.addTopLevelView(o.__views.account),o.__views.__alloyId18=Ti.UI.createView({height:"20dp",width:Ti.UI.FILL,id:"__alloyId18"}),o.__views.account.add(o.__views.__alloyId18),o.__views.profile=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"profile",titleid:"edit_profile"}),o.__views.account.add(o.__views.profile),e?o.__views.profile.addEventListener("touchstart",e):a["$.__views.profile!touchstart!buttonTouchStart"]=!0,t?o.__views.profile.addEventListener("touchend",t):a["$.__views.profile!touchend!buttonTouchEnd"]=!0,o.__views.supplier=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"supplier",titleid:"add_company"}),o.__views.account.add(o.__views.supplier),e?o.__views.supplier.addEventListener("touchstart",e):a["$.__views.supplier!touchstart!buttonTouchStart"]=!0,t?o.__views.supplier.addEventListener("touchend",t):a["$.__views.supplier!touchend!buttonTouchEnd"]=!0,o.__views.blackList=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"blackList",titleid:"my_black_list"}),o.__views.account.add(o.__views.blackList),e?o.__views.blackList.addEventListener("touchstart",e):a["$.__views.blackList!touchstart!buttonTouchStart"]=!0,t?o.__views.blackList.addEventListener("touchend",t):a["$.__views.blackList!touchend!buttonTouchEnd"]=!0,o.__views.adverts=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"adverts",titleid:"my_adverts"}),o.__views.account.add(o.__views.adverts),e?o.__views.adverts.addEventListener("touchstart",e):a["$.__views.adverts!touchstart!buttonTouchStart"]=!0,t?o.__views.adverts.addEventListener("touchend",t):a["$.__views.adverts!touchend!buttonTouchEnd"]=!0,o.__views.deals=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"deals",titleid:"my_deals"}),o.__views.account.add(o.__views.deals),e?o.__views.deals.addEventListener("touchstart",e):a["$.__views.deals!touchstart!buttonTouchStart"]=!0,t?o.__views.deals.addEventListener("touchend",t):a["$.__views.deals!touchend!buttonTouchEnd"]=!0,o.__views.products=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"products",titleid:"my_products"}),o.__views.account.add(o.__views.products),e?o.__views.products.addEventListener("touchstart",e):a["$.__views.products!touchstart!buttonTouchStart"]=!0,t?o.__views.products.addEventListener("touchend",t):a["$.__views.products!touchend!buttonTouchEnd"]=!0,o.__views.offers=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"offers",titleid:"my_offers"}),o.__views.account.add(o.__views.offers),e?o.__views.offers.addEventListener("touchstart",e):a["$.__views.offers!touchstart!buttonTouchStart"]=!0,t?o.__views.offers.addEventListener("touchend",t):a["$.__views.offers!touchend!buttonTouchEnd"]=!0,o.__views.offers_badge=Ti.UI.createLabel({right:10,top:10,color:"#FFFFFF",textAlign:"center",font:{fontSize:14},backgroundColor:"#e83038",borderRadius:10,height:20,width:20,visible:!1,id:"offers_badge"}),o.__views.offers.add(o.__views.offers_badge),o.__views.reports=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"reports",titleid:"reports"}),o.__views.account.add(o.__views.reports),e?o.__views.reports.addEventListener("touchstart",e):a["$.__views.reports!touchstart!buttonTouchStart"]=!0,t?o.__views.reports.addEventListener("touchend",t):a["$.__views.reports!touchend!buttonTouchEnd"]=!0,o.__views.answers=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"answers",titleid:"my_answers"}),o.__views.account.add(o.__views.answers),e?o.__views.answers.addEventListener("touchstart",e):a["$.__views.answers!touchstart!buttonTouchStart"]=!0,t?o.__views.answers.addEventListener("touchend",t):a["$.__views.answers!touchend!buttonTouchEnd"]=!0,o.__views.answers_badge=Ti.UI.createLabel({right:10,top:10,color:"#FFFFFF",textAlign:"center",font:{fontSize:14},backgroundColor:"#e83038",borderRadius:10,height:20,width:20,visible:!1,id:"answers_badge"}),o.__views.answers.add(o.__views.answers_badge),o.__views.buyBanner=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"buyBanner",titleid:"buy_banner"}),o.__views.account.add(o.__views.buyBanner),e?o.__views.buyBanner.addEventListener("touchstart",e):a["$.__views.buyBanner!touchstart!buttonTouchStart"]=!0,t?o.__views.buyBanner.addEventListener("touchend",t):a["$.__views.buyBanner!touchend!buttonTouchEnd"]=!0,o.__views.logout=Ti.UI.createButton({width:Ti.UI.FILL,left:"5dp",right:"5dp",height:"40dp",bottom:"20dp",style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:Alloy.Globals.Styles.buttonBg,id:"logout",titleid:"logout"}),o.__views.account.add(o.__views.logout),r?o.__views.logout.addEventListener("click",r):a["$.__views.logout!click!logout"]=!0,s.destroy=function(){},_.extend(o,o.__views),Alloy.Globals.core.profile&&Alloy.Globals.core.profile.supplier&&(o.supplier.title=L("edit_company"));var l=Alloy.Globals.indicator;Alloy.Globals.chat.openChatId=!1,Ti.App.addEventListener("account:refreshCounts",i),Ti.App.addEventListener("account:itIsSupplier",function(){o.supplier.title=L("edit_company")}),a["$.__views.profile!touchstart!buttonTouchStart"]&&o.__views.profile.addEventListener("touchstart",e),a["$.__views.profile!touchend!buttonTouchEnd"]&&o.__views.profile.addEventListener("touchend",t),a["$.__views.supplier!touchstart!buttonTouchStart"]&&o.__views.supplier.addEventListener("touchstart",e),a["$.__views.supplier!touchend!buttonTouchEnd"]&&o.__views.supplier.addEventListener("touchend",t),a["$.__views.blackList!touchstart!buttonTouchStart"]&&o.__views.blackList.addEventListener("touchstart",e),a["$.__views.blackList!touchend!buttonTouchEnd"]&&o.__views.blackList.addEventListener("touchend",t),a["$.__views.adverts!touchstart!buttonTouchStart"]&&o.__views.adverts.addEventListener("touchstart",e),a["$.__views.adverts!touchend!buttonTouchEnd"]&&o.__views.adverts.addEventListener("touchend",t),a["$.__views.deals!touchstart!buttonTouchStart"]&&o.__views.deals.addEventListener("touchstart",e),a["$.__views.deals!touchend!buttonTouchEnd"]&&o.__views.deals.addEventListener("touchend",t),a["$.__views.products!touchstart!buttonTouchStart"]&&o.__views.products.addEventListener("touchstart",e),a["$.__views.products!touchend!buttonTouchEnd"]&&o.__views.products.addEventListener("touchend",t),a["$.__views.offers!touchstart!buttonTouchStart"]&&o.__views.offers.addEventListener("touchstart",e),a["$.__views.offers!touchend!buttonTouchEnd"]&&o.__views.offers.addEventListener("touchend",t),a["$.__views.reports!touchstart!buttonTouchStart"]&&o.__views.reports.addEventListener("touchstart",e),a["$.__views.reports!touchend!buttonTouchEnd"]&&o.__views.reports.addEventListener("touchend",t),a["$.__views.answers!touchstart!buttonTouchStart"]&&o.__views.answers.addEventListener("touchstart",e),a["$.__views.answers!touchend!buttonTouchEnd"]&&o.__views.answers.addEventListener("touchend",t),a["$.__views.buyBanner!touchstart!buttonTouchStart"]&&o.__views.buyBanner.addEventListener("touchstart",e),a["$.__views.buyBanner!touchend!buttonTouchEnd"]&&o.__views.buyBanner.addEventListener("touchend",t),a["$.__views.logout!click!logout"]&&o.__views.logout.addEventListener("click",r),_.extend(o,s)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;