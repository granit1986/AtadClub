function __processArg(e,t){var l=null;return e&&(l=e[t]||null,delete e[t]),l}function Controller(){function e(t){if(!t||!t.fromAdapter){e.opts||{};for(var o=l(r),a=o.length,s=[],n=0;a>n;n++){var d=o[n];d.__transform={};var c=Alloy.createController("subCategories/row",{$model:d});s.push(c.getViewEx({recurse:!0}))}i.__views.categories.setData(s)}}function t(){v.openIndicator(),i.window.title=d,Alloy.Collections.subCategories.fetch({cache:{name:"subCategories",validMinutes:60},success:function(){var e=Alloy.Collections.subCategories.where({categoryId:n}).length,t=Alloy.Globals.core.currentSectionCategories()["_"+n];t&&e==Object.size(t)&&(p=!1),w.addEventListener("click",function(){if(p){for(var e=0;e<g.length;e++){var t=g[e],l=i.categories.data[0].rows[e];y.subCategories.selected({categoryId:t.attributes.categoryId,id:t.id},Alloy.Globals.core.currentSectionCategories())||(y.subCategories.select({categoryId:t.attributes.categoryId,id:t.id},Alloy.Globals.core.currentSectionCategories()),l.hasCheck=!0)}p=!1}else{for(var e=0;e<g.length;e++){var t=g[e],l=i.categories.data[0].rows[e];y.subCategories.selected({categoryId:t.attributes.categoryId,id:t.id},Alloy.Globals.core.currentSectionCategories())&&(y.subCategories.clear({categoryId:t.attributes.categoryId,id:t.id},Alloy.Globals.core.currentSectionCategories()),l.hasCheck=!1)}p=!0}})},error:function(){v.closeIndicator(),Alloy.Globals.core.showErrorDialog(L("xhr_error"))}})}function l(e){return g=e.where({categoryId:n}),v.closeIndicator(),g}function o(){c&&c(n)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="subCategories/index",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,a={},s={};i.__views.window=Ti.UI.createWindow({backgroundImage:"images/background.png",layout:"vertical",id:"window",fullscreen:"true"}),i.__views.window&&i.addTopLevelView(i.__views.window),o?i.__views.window.addEventListener("close",o):s["$.__views.window!close!onClose"]=!0,t?i.__views.window.addEventListener("open",t):s["$.__views.window!open!open"]=!0,i.__views.categories=Ti.UI.createTableView({backgroundColor:"#00ffffff",top:"20dp",bottom:"20dp",id:"categories",separatorColor:"transparent"}),i.__views.window.add(i.__views.categories);var r=Alloy.Collections.subCategories||subCategories;r.on("fetch destroy change add remove reset",e),a.destroy=function(){r.off("fetch destroy change add remove reset",e)},_.extend(i,i.__views);var n=arguments[0].categoryId,d=arguments[0].categoryName,c=arguments[0].closeCallback||null,u=arguments[0].sectionName||null;arguments[0].win||null;var y=Alloy.Globals.core;y.currentSection=u;var p=!0,w=Ti.UI.createButton({titleid:"select_all"});i.window.setRightNavButton(w);var g,v=Alloy.Globals.indicator;s["$.__views.window!close!onClose"]&&i.__views.window.addEventListener("close",o),s["$.__views.window!open!open"]&&i.__views.window.addEventListener("open",t),_.extend(i,a)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;