function __processArg(e,t){var l=null;return e&&(l=e[t]||null,delete e[t]),l}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="map/index",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,t={};e.__views.window=Ti.UI.createWindow({backgroundImage:Alloy.Globals.Styles.backgroundImage,layout:"",backgroundColor:"#fff",fullscreen:"true",id:"window"}),e.__views.window&&e.addTopLevelView(e.__views.window),e.__views.search=Ti.UI.createSearchBar({height:"40dp",top:"5dp",left:"5dp",right:"50dp",font:{fontSize:"13dp",fontFamily:"Arial"},backgroundColor:"#fff",zIndex:"10",id:"search"}),e.__views.window.add(e.__views.search),e.__views.send=Ti.UI.createButton({top:"5dp",height:"40dp",width:"40dp",right:"5dp",zIndex:10,style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:"#007aff",id:"send",title:"ok"}),e.__views.window.add(e.__views.send),e.__views.findMe=Ti.UI.createButton({bottom:"5dp",height:"30dp",width:"30dp",left:"5dp",zIndex:10,style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,font:{fontFamily:"Avenir Next Condensed",fontSize:"20dp"},color:"#fff",textAlign:"center",verticalAlign:"center",backgroundColor:"#007aff",backgroundImage:"images/icon_location.png",backgroundRepeat:!1,id:"findMe"}),e.__views.window.add(e.__views.findMe),e.__views.map=Alloy.createController("map/map",{id:"map",__parentSymbol:e.__views.window}),e.__views.map.setParent(e.__views.window),t.destroy=function(){},_.extend(e,e.__views);var l=arguments[0].callback,o=arguments[0].title;e.search.value=o,e.window.open();var i=Alloy.Globals.geo;e.send.addEventListener("click",function(){l&&l(e.search.value),e.window.close()}),e.findMe.addEventListener("click",function(){var t=Alloy.Globals.geo;t.checkLocation(function(){return t.location.status!=t.errors.NONE?void Alloy.Globals.core.showErrorDialog(L(t.location.status.message)):void t.reverseGeocoding(t.location.latitude,t.location.longitude,function(t){if(t.error)Alloy.Globals.core.showErrorDialog(L(t.message?t.message:t.error));else{e.search.value=t.response.results[0].formatted_address;var l={title:e.search.value,response:{results:[{geometry:{location:{lat:t.response.results[0].geometry.location.lat,lng:t.response.results[0].geometry.location.lng}}}]}};e.map.addAnnotation(l)}})})});var a=function(){e.search.blur(),i.geocoding(e.search.value,function(t){return t.error?void Alloy.Globals.core.showErrorDialog(L(t.message)):(e.map.addAnnotation(t),void e.trigger("addAnnotation",{geodata:t}))})};a(),e.search.addEventListener("return",function(){a()}),_.extend(e,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;