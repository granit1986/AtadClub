var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._,Controller=function(){function e(){return n.__widgetId?{widgetId:n.__widgetId,name:n.__controllerPath}:n.__controllerPath}var t=[],n=this;this.__iamalloy=!0,_.extend(this,Backbone.Events,{__views:{},__proxyProperties:{},setParent:function(e){var n=t.length;if(n){this.parent=e.__iamalloy?e.parent:e;for(var r=0;n>r;r++)t[r].__iamalloy?t[r].setParent(this.parent):this.parent.add(t[r])}},addTopLevelView:function(e){t.push(e)},addProxyProperty:function(e,t){this.__proxyProperties[e]=t},removeProxyProperty:function(e){delete this.__proxyProperties[e]},getTopLevelViews:function(){return t},getView:function(e){return"undefined"==typeof e||null===e?t[0]:this.__views[e]},removeView:function(e){delete this[e],delete this.__views[e]},getProxyProperty:function(e){return this.__proxyProperties[e]},getViews:function(){return this.__views},destroy:function(){},getViewEx:function(e){var t=e.recurse||!1;if(t){var n=this.getView();return n?n.__iamalloy?n.getViewEx({recurse:!0}):n:null}return this.getView()},getProxyPropertyEx:function(e,t){var n=t.recurse||!1;if(n){var r=this.getProxyProperty(e);return r?r.__iamalloy?r.getProxyProperty(e,{recurse:!0}):r:null}return this.getView(e)},createStyle:function(t){return Alloy.createStyle(e(),t)},UI:{create:function(t,n){return Alloy.UI.create(e(),t,n)}},addClass:function(t,n,r){return Alloy.addClass(e(),t,n,r)},removeClass:function(t,n,r){return Alloy.removeClass(e(),t,n,r)},resetClass:function(t,n,r){return Alloy.resetClass(e(),t,n,r)},updateViews:function(e){var t=this.getViews();return _.isObject(e)&&_.each(_.keys(e),function(n){var r=t[n.substring(1)];0===n.indexOf("#")&&"#"!==n&&_.isObject(r)&&"function"==typeof r.applyProperties&&r.applyProperties(e[n])}),this}})};module.exports=Controller;