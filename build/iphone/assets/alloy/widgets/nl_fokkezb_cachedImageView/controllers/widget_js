function WPATH(t){var l=t.lastIndexOf("/"),e=-1===l?"nl.fokkezb.cachedImageView/"+t:t.substring(0,l)+"/nl.fokkezb.cachedImageView/"+t.substring(l+1);return e}function __processArg(t,l){var e=null;return t&&(e=t[l]||null,delete t[l]),e}function Controller(){function t(t){Ti.API.info("Setting new image"),e({image:t})}function l(t){Ti.API.info("image path "+t);var l=s?s:o.imageView.image;return t&&"string"!=typeof l?l.resolve?l.resolve():l.nativePath?l.nativePath:void 0:l}function e(t){if(t.cacheHires&&n&&(t.image=t.cacheHires,t.hires=!0),!t.image||_.isString(t.image)&&!Ti.Platform.canOpenURL(t.image))delete t.image,e=!1;else if(!t.cacheNot){if(!t.cacheName)if(_.isString(t.image))t.cacheName=t.image;else{if(!t.image.nativePath)throw new Error("For non-file blobs you need to set a cacheName manually.");t.cacheName=t.image.nativePath}if(t.cacheName=Ti.Utils.md5HexDigest(t.cacheName),t.hires&&(t.cacheName=t.cacheName+"@2x"),!t.cacheExtension){var l=/(?:\.([^.]+))?$/;l.exec(t.image)[1],t.cacheExtension="jpeg"}s=Ti.Filesystem.getFile(Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory).nativePath,t.cacheName+"."+t.cacheExtension);var e=!0;s.exists()&&(t.image=s,e=!1)}var i=t.image;if(delete t.id,delete t.cacheName,delete t.cacheExtension,delete t.cacheHires,delete t.$model,delete t.__parentSymbol,!0===e){delete t.image,o.imageView.applyProperties(t);var r=Ti.Network.createHTTPClient();r.onload=function(){s.write(this.responseData),o.imageView.image=s},r.open("GET",i),r.send()}else o.imageView.applyProperties(t)}new(require("alloy/widget"))("nl.fokkezb.cachedImageView"),this.__widgetId="nl.fokkezb.cachedImageView",require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="widget",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var o=this,i={};o.__views.imageView=Ti.UI.createImageView({id:"imageView"}),o.__views.imageView&&o.addTopLevelView(o.__views.imageView),i.destroy=function(){},_.extend(o,o.__views);var s,r=arguments[0]||{},n="high"===Ti.Platform.displayCaps.density;e(r),Object.defineProperty(o,"image",{get:l,set:t}),i.setImage=t,i.getImage=l,i.init=e,i.applyProperties=e,i.on=i.addEventListener=function(t,l){return o.imageView.addEventListener(t,l)},i.off=i.removeEventListener=function(t,l){return o.imageView.removeEventListener(t,l)},i.trigger=i.fireEvent=function(t,l){return o.imageView.fireEvent(t,l)},_.extend(o,i)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;