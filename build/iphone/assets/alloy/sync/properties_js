function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(t,l,e){var o=l.config.adapter.collection_name?l.config.adapter.collection_name:"default",i=new RegExp("^("+o+")\\-(.+)$"),s=null;if("read"===t)if(e.parse){var r=[];_.each(TAP.listProperties(),function(t){var l=t.match(i);null!==l&&r.push(TAP.getObject(t))}),s=r}else{var a=TAP.getObject(o+"-"+l.id);l.set(a),s=l.toJSON()}else"create"===t||"update"===t?(l.id||(l.id=guid(),l.set(l.idAttribute,l.id)),TAP.setObject(o+"-"+l.id,l.toJSON()||{}),s=l.toJSON()):"delete"===t&&(TAP.removeProperty(o+"-"+l.id),l.clear(),s=l.toJSON());s?(_.isFunction(e.success)&&e.success(s),"read"===t&&l.trigger("fetch")):_.isFunction(e.error)&&e.error(s)}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(t){return t=t||{},t.columns=t.columns||{},t.defaults=t.defaults||{},("undefined"==typeof t.columns.id||null===t.columns.id)&&(t.columns.id="String"),t};