function ucfirst(t){return t?t[0].toUpperCase()+t.substr(1):t}function addNamespace(t){return(CONST.IMPLICIT_NAMESPACES[t]||CONST.NAMESPACE_DEFAULT)+"."+t}function processStyle(t,l,e,o,i){o=o||{},o.classes=e,l.apiName&&(o.apiName=l.apiName),l.id&&(o.id=l.id),l.applyProperties(exports.createStyle(t,o,i))}function isTabletFallback(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=700}function deepExtend(){var t,l,e,o,i,s,r=arguments[0]||{},n=1,a=arguments.length,y=!1;for("boolean"==typeof r&&(y=r,r=arguments[1]||{},n=2),"object"==typeof r||_.isFunction(r)||(r={});a>n;n++)if(t=arguments[n],null!=t){"string"==typeof t&&(t=t.split(""));for(l in t)e=r[l],o=t[l],r!==o&&(y&&o&&(_.isObject(o)&&!_.has(o,"apiName")||(i=_.isArray(o)))&&!o.colors?(i?(i=!1,s=e&&_.isArray(e)?e:[]):s=_.isDate(o)?new Date(o.valueOf()):e&&_.isObject(e)?e:{},r[l]=deepExtend(y,s,o)):"undefined"!=typeof o?r[l]=o:o.colors&&(r[l]=o))}return r}var _=require("alloy/underscore")._,Backbone=require("alloy/backbone"),CONST=require("alloy/constants");exports.version="1.5.1",exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET="widget",TI_VERSION=Ti.version,MW320_CHECK=!1,IDENTITY_TRANSFORM=void 0,RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:null,font:null,visible:!0,color:null,transform:null,backgroundGradient:{},borderColor:"transparent",borderRadius:0,borderWidth:0};RESET=_.extend(RESET,{backgroundLeftCap:0,backgroundTopCap:0}),exports.M=function(t,l,e){var o,i=(l||{}).config||{},s=i.adapter||{},r={},n={};s.type?(o=require("alloy/sync/"+s.type),r.sync=function(t,l,e){o.sync(t,l,e)}):r.sync=function(t,l){Ti.API.warn("Execution of "+t+"#sync() function on a model that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(l.toJSON()))},r.defaults=i.defaults,e&&(n.migrations=e),o&&_.isFunction(o.beforeModelCreate)&&(i=o.beforeModelCreate(i,t)||i);var a=Backbone.Model.extend(r,n);return a.prototype.config=i,_.isFunction(l.extendModel)&&(a=l.extendModel(a)||a),o&&_.isFunction(o.afterModelCreate)&&o.afterModelCreate(a,t),a},exports.C=function(t,l,e){var o,i={model:e},s=(e?e.prototype.config:{})||{};s.adapter&&s.adapter.type?(o=require("alloy/sync/"+s.adapter.type),i.sync=function(t,l,e){o.sync(t,l,e)}):i.sync=function(t,l){Ti.API.warn("Execution of "+t+"#sync() function on a collection that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(l.toJSON()))};var r=Backbone.Collection.extend(i);return r.prototype.config=s,_.isFunction(l.extendCollection)&&(r=l.extendCollection(r)||r),o&&_.isFunction(o.afterCollectionCreate)&&o.afterCollectionCreate(r),r},exports.UI={},exports.UI.create=function(controller,apiName,opts){opts=opts||{};var baseName,ns,parts=apiName.split(".");if(1===parts.length)baseName=apiName,ns=opts.ns||CONST.IMPLICIT_NAMESPACES[baseName]||CONST.NAMESPACE_DEFAULT;else{if(!(parts.length>1))throw"Alloy.UI.create() failed: No API name was given in the second parameter";baseName=parts[parts.length-1],ns=parts.slice(0,parts.length-1).join(".")}opts.apiName=ns+"."+baseName,baseName=baseName[0].toUpperCase()+baseName.substr(1);var style=exports.createStyle(controller,opts);return eval(ns)["create"+baseName](style)},exports.createStyle=function(t,l,e){var o,i;if(!l)return{};o=_.isArray(l.classes)?l.classes.slice(0):_.isString(l.classes)?l.classes.split(/\s+/):[],i=l.apiName,i&&-1===i.indexOf(".")&&(i=addNamespace(i));var s;s=require(t&&_.isObject(t)?"alloy/widgets/"+t.widgetId+"/styles/"+t.name:"alloy/styles/"+t);var r,n,a={};for(r=0,n=s.length;n>r;r++){var y=s[r],d=y.key;if(y.isApi&&-1===d.indexOf(".")&&(d=(CONST.IMPLICIT_NAMESPACES[d]||CONST.NAMESPACE_DEFAULT)+"."+d),y.isId&&l.id&&y.key===l.id||y.isClass&&_.contains(o,y.key));else{if(!y.isApi)continue;if(-1===y.key.indexOf(".")&&(y.key=addNamespace(y.key)),y.key!==i)continue}y.queries&&y.queries.formFactor&&!Alloy[y.queries.formFactor]||deepExtend(!0,a,y.style)}var p=_.omit(l,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return deepExtend(!0,a,p),a[CONST.CLASS_PROPERTY]=o,a[CONST.APINAME_PROPERTY]=i,MW320_CHECK&&delete a[CONST.APINAME_PROPERTY],e?_.defaults(a,e):a},exports.addClass=function(t,l,e,o){if(!e)return void(o&&(MW320_CHECK&&delete o.apiName,l.applyProperties(o)));var i=l[CONST.CLASS_PROPERTY]||[],s=i.length;e=_.isString(e)?e.split(/\s+/):e;var r=_.union(i,e||[]);return s===r.length?void(o&&(MW320_CHECK&&delete o.apiName,l.applyProperties(o))):void processStyle(t,l,r,o)},exports.removeClass=function(t,l,e,o){e=e||[];var i=l[CONST.CLASS_PROPERTY]||[],s=i.length;if(!s||!e.length)return void(o&&(MW320_CHECK&&delete o.apiName,l.applyProperties(o)));e=_.isString(e)?e.split(/\s+/):e;var r=_.difference(i,e);return s===r.length?void(o&&(MW320_CHECK&&delete o.apiName,l.applyProperties(o))):void processStyle(t,l,r,o,RESET)},exports.resetClass=function(t,l,e,o){e=e||[],e=_.isString(e)?e.split(/\s+/):e,processStyle(t,l,e,o,RESET)},exports.createWidget=function(t,l,e){return"undefined"!=typeof l&&null!==l&&_.isObject(l)&&!_.isString(l)&&(e=l,l=DEFAULT_WIDGET),new(require("alloy/widgets/"+t+"/controllers/"+(l||DEFAULT_WIDGET)))(e)},exports.createController=function(t,l){return new(require("alloy/controllers/"+t))(l)},exports.createModel=function(t,l){return new(require("alloy/models/"+ucfirst(t)).Model)(l)},exports.createCollection=function(t,l){return new(require("alloy/models/"+ucfirst(t)).Collection)(l)},exports.isTablet=function(){return"ipad"===Ti.Platform.osname}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(t){return exports.Models[t]||(exports.Models[t]=exports.createModel(t))},exports.Collections={},exports.Collections.instance=function(t){return exports.Collections[t]||(exports.Collections[t]=exports.createCollection(t))},exports.CFG=require("alloy/CFG");